library(knitr)
library(dplyr)
library(readxl)
library(ggplot2)
library(corrplot)
library(Hmisc)
data <- read.csv("card.csv", sep = ",", skip = 2, header = FALSE)
header <- scan("card.csv",sep=",",nlines=2,what=character())
head(data)
head(data)
glimpse(data)
str(data)
#Checking for NA values
any(is.na(data))
summary(data)
#Correlation matrix
data_onlycat <- subset(data, select = c(c(V3,V4,V5,V7,V8,V9,V10,V11,V12)))
corrplot(cor(data_onlycat))
#Replacing values
data$V7[data$V7 >2 ]<- 2
data$V8[data$V8 >2 ]<- 2
data$V9[data$V9 >2 ]<- 2
data$V10[data$V10 >2 ]<- 2
data$V11[data$V11 >2 ]<- 2
data$V12[data$V12 >2 ]<- 2
data$GENDER = ifelse(data$V3 == 1, "Male", "Female")
#V4: Education (1 = graduate school; 2 = university; 3 = high school; 4 = others).
data$EDUCATION <- ifelse(data$V4%in%c(0,4,5,6), 0, data$V4)
data$EDUCATION <- factor(data$EDUCATION,
labels = c("Others","Graduate_school", "University", "High_school"))
data$default <- as.factor(data$V25)
# Bar Graph for gender
gender_plot<- ggplot(data, aes(GENDER))+
geom_bar(aes(fill=default), width = 0.5) +
labs(title="Gender") +
stat_count(aes(label = ..count..), geom = "label")
gender_plot
# Bar graph for Education
education_plot <- data %>%
count(EDUCATION, default) %>%
group_by(EDUCATION) %>%
mutate(n = n/sum(n) * 100) %>%
ggplot() +
aes(factor(EDUCATION,
levels = c("Others", "High_school", "University", "Graduate_school")), n,
fill = default, label = paste0(round(n, 2), "%")) +
geom_col() +
geom_text(position=position_stack(0.5))+
xlab("Education")+
ylab("%")
education_plot
#Bar graph for default
default_plot <- ggplot(data, aes(default))+
geom_bar(aes(fill=default), width = 0.5) +
labs(title="Number of Defaults")+
stat_count(aes(label = ..count..), geom = "label")
default_plot
help(upsampling)
help(upsample)
install.packages("caret")
install.packages("caret")
install.packages("caret")
install.packages("caret")
#Used for balancing Data
library(caret)
if(!require(caret)) install.packages("caret", repos = "http://cran.us.r-project.org")
#Used for balancing Data
library(caret)
update.packages()
#Used for balancing Data
library(caret)
#Used for balancing Data
library(caret)
update.packages(lifecycle)
install.packages(lifecycle)
install.packages("caret", dependencies = c("Depends", "Suggests"))
